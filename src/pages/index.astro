---
// Layout import
import BaseLayout from '../layouts/BaseLayout.astro';

// Component Imports
import Hero from '../components/Hero.astro';
import AboutSection from '../components/AboutSection.astro';
import SkillsList from '../components/SkillsList.astro';
import WorksSection from '../components/WorksSection.astro';
---

<BaseLayout>
	<div class="bg-circles"></div>
	<div class="page-spacing">
		<div class="stack gap-30 lg:gap-24">
			<div class="wrapper stack gap-8 lg:gap-10">
				<header class="hero">
					<Hero
						title="Kengo Hoi"
						tagline="Welcome to my portfolio!"
						align="center"
					>
					</Hero>
				</header>
			</div>

			<AboutSection />
			<SkillsList />
			<WorksSection />

		</div>
	</div>
</BaseLayout>

<script type="module">
  document.addEventListener("DOMContentLoaded", () => {
    // === 背景円のアニメーション ===
    const container = document.querySelector(".bg-circles");
    const NUM = 20;

    for (let i = 0; i < NUM; i++) {
      const el = document.createElement("div");
      el.classList.add("bg-circle");
      const size = Math.random() * 200 + 50;
      el.style.width = `${size}px`;
      el.style.height = `${size}px`;
      el.style.left = `${Math.random() * 100}%`;
      el.style.top = `${Math.random() * 100}%`;
      el.style.backgroundColor = `rgba(190, 160, 230, ${Math.random() * 0.2 + 0.05})`;
      container.appendChild(el);
    }

    // スクロール時のアニメーション
    window.addEventListener("scroll", () => {
      const scrollY = window.scrollY;
      document.querySelectorAll(".bg-circle").forEach((c, idx) => {
        const speed = (idx % 5 + 1) * 0.1; // 円ごとに異なる速度
        c.style.transform = `translateY(-${scrollY * speed}px)`;
      });
    });

    // === Scroll Reveal Animation ===
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('in-view');
                observer.unobserve(entry.target); // 一度表示されたら監視終了
            }
        });
    }, observerOptions);

    const elements = document.querySelectorAll('.scroll-reveal');
    elements.forEach(el => observer.observe(el));
  });
</script>

<style>
	.hero {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 2rem;
  		margin-bottom: 6rem; 	/* モバイルでの下マージン拡大 */
	}

	.roles {
		display: none;
	}

	.hero img {
		aspect-ratio: 5 / 4;
		object-fit: cover;
		object-position: top;
		border-radius: 1.5rem;
		box-shadow: var(--shadow-md);
	}

	@media (min-width: 50em) {
		.hero {
			display: grid;
			grid-template-columns: 1fr;
			padding-inline: 2.5rem;
			gap: 3.75rem;
		  	margin-bottom: 10rem; /* PCでの下マージン拡大 */
		}

		.roles {
			margin-top: 0.5rem;
			display: flex;
			gap: 0.5rem;
		}

		.hero img {
			aspect-ratio: 3 / 4;
			border-radius: 4.5rem;
			object-fit: cover;
		}
	}

	.page-spacing { padding-block: 8rem; }     /* 上下のベースパディング拡大 */
	@media (min-width: 50em) {
		.page-spacing { padding-block: 12rem; }   /* PCでのパディング拡大 */
	}

	/* 背景円全体ラッパー */
	.bg-circles {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		overflow: hidden;
		pointer-events: none;
		z-index: -1;
	}

	.bg-circle {
		position: absolute;
		border-radius: 50%;
		will-change: transform;
		transition: transform 0.1s linear;
	}
</style>